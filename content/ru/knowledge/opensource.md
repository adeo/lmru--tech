---
title: "Готовим код к open source"
description: "Короткая инструкция по причёсыванию кода."
simple_list: true
type: docs
---

Мы активно используем продукты open source, созданные и поддерживаемые энтузиастами со всего мира.
Однако мы хотим не просто использовать, но и контрибьютить обратно, 
участвуя в разработке open source продуктов и поддерживая сообщество.

Это инструкция для команд на тему «Что мне нужно сделать чтобы заопенсорсить код».

## Готовим код к open source в 3 этапа

{{< blocks/section color="white" >}}
{{% blocks/feature icon="fa-dice-one" title="Шаг 1" %}}
Проверка указания авторства и оригинальности кода
{{% /blocks/feature %}}

{{% blocks/feature icon="fa-dice-two" title="Шаг 2" %}}
Выбор лицензии
{{% /blocks/feature %}}

{{% blocks/feature icon="fa-dice-three" title="Шаг 3" %}}
Проверка совместимости сторонних зависимостей
{{% /blocks/feature %}}
{{< /blocks/section >}}

### Шаг 1. Проверка указания авторства и оригинальности кода.
Необходимо зафиксировать список участников проекта. Для каждого участника определить:

* Имя и фамилию – Pavel Griboedov
* Компанию — LLC «Leroy Merlin Vostok»
* Контактную почту – pavel.griboedov@leroymerlin.ru

#### Указание правильной информации в `git`

Обязательно отправлять корректную мета-информацию с каждым коммитом.
По этой информации определяется авторство кода.

```
git config --global user.name "Pavel Griboedov"
git config --global user.email "pavel.griboedov@leroymerlin.ru"
```

Нельзя привлекать временных работников или практикантов к разработке собственных продуктов,
которые будем выкладывать в open source, а также к работе над внешними open source проектами.

В случае, если для нас пишет код внешняя компания, необходимо иметь правильно составленный контракт с отчуждением прав, 
а также дополнительно указывать принадлежность кода в исходниках и в документации.

#### Проверка оригинальности
«*Оригинальность*» — это важный юридический термин. Мы обладаем юридическими правами только если код *оригинальный*.
На практике, оригинальность кода определяется возможностью выделить так называемые *design decision*.

{{< alert color="success" title="Design Decision" >}}
Персональная интеллектуальная контрибьюция разработчика, демонстрирующая факт,
что другой разработчик решил бы похожую проблему иначе.

![Это Design Decision](/images/design_decision.jpg)
{{< /alert >}}

{{< alert color="danger" title="Не Design Decision" >}}
Автоматически сгенерированный код либо код, который можно написать единственным образом.

![Это не Design Decision](/images/not_design_decision.jpg)
{{< /alert >}}

### Шаг 2. Выбор лицензии.
Самый сложный и одновременно важный этап это выбор правильной лицензии для кода.
На выбор могут повлиять лицензии сторонних библиотек, использованных в проекте, об этом подробнее в [3 шаге](#шаг-3-проверка-совместимости-сторонних-зависимостей).

##### Лицензии copyleft
Как правило, copyleft лицензии требуют использования лицензии похожего типа, 
в случае, когда распространяется код вместе со твоим. Другими словами, 
если кто-то захочет использовать библиотеку с copyleft лицензией и начнёт распространять своё ПО,
то делать это он будет должен тоже по свободной copyleft лицензии.

Самая популярная лицензия этого типа — [GNU GPLv3](https://choosealicense.com/licenses/gpl-3.0/).
Даёт возможность делать с твоим проектом почти всё что угодно, за исключением дистрибьюции с закрытым кодом.

##### Лицензии copyright
Этот тип лицензий разрешает всем использовать и распространять продукты, содержащие твой код, даже в закрытых проприетарных решениях. 

* BSD — есть две основные редакции.
[Оригинальная](https://opensource.org/licenses/BSD-3-Clause) версия обязывает добавлять рекламную строчку используемой библиотеки во вссех продуктах, использующих твой код:
«`Продукт использует программу разработанную в компании Рога и копыта`».
[Изменённая и укороченная](https://opensource.org/licenses/bsd-license.php) версия не включает это обязательство.
Две разные версии именуются одинаково и для избежания путаницы мы *не рекомендуем* использовать эту лицензию.
А ещё, эта лицензия полностью игнорирует патентные права, о которых чуть дальше.

* [MIT](https://opensource.org/licenses/MIT) - короткая лицензия в несколько параграфов.
Нравится разработчикам за свою простоту, она отлично подходит небольшим проектам.
Однако она была изобретена до того момента, как патентные права стали применяться часто, и, как следствие, лицензия никак не покрывает эту тему.

{{< alert color="primary" title="Разница между правами копирайта и патентными правами" >}}
Существует две полностью независимые формы прав на интеллектуальную собственность,
которые применяются для защиты кода от нежелательного использования или модификации:

* Копирайт
* Патент

Копирайт защищает «выражение идеи» и применяется к исходному коду.
Копирайт вступает в силу автоматически после написания кода.
Копирайт даёт право копировать или изменять код только его автору.
Автор кода может разрешить третьим лицам совершать эти действия с помощью копирайтной лицензии.

Патент защищает изобретения. Для патентной защиты необходимо получить патент на изобретение. После получения, 
ты будешь обладать эксклюзивными правами по использованию изобретения, либо сможешь передать патентные права третьим лицам.

Понятие патента шире копирайта: если кто-то ещё создаст похожее ПО, которое было запотентовано ранее тобой, 
ты сможешь запретить использование подобной программы или предложить купить патентное разрешение. В случае копирайта,
возможен тот случай, когда несколько людей независимо написали очень похожий код, и каждое из этих решений охраняется копирайтом.

[источник](https://opensource.stackexchange.com/questions/6302/what-does-express-grant-of-patent-rights-from-contributors-to-users-mean)
{{< /alert >}}

* [Apache 2.0](https://www.apache.org/licenses/LICENSE-2.0.txt) —
одна из самых популярных open source лицензий, используемая в [CNCF](https://www.cncf.io/) и [Apache Foundation](https://www.apache.org/licenses/).
Длиннее чем MIT, но покрывает ещё и вопрос с патентами.

#### Рекомендованный выбор лицензии для большинства случаев
По умолчанию мы предлагаем тебе использовать 
<abbr data-toggle="tooltip" title="Это означает что любой сможет распространять твой код в своих закрытых проприетарных продуктах.">copyright</abbr>
 open source лицензию – [Apache 2.0](https://www.apache.org/licenses/LICENSE-2.0.txt).

{{< alert color="primary" title="Apache License 2.0" >}}
Разрешительная лицензия, основное требование которой сохранение информации о копирайте и лицензии.
Разрешает в том числе и патентное использование.
Лицензированный код, его модификации и работы на его основе могут распространяться под другой лицензией, даже закрытой, и не включать исходный код.

![Лицензия Apache](/images/apache_license.jpg)

[источник](https://choosealicense.com/licenses/apache-2.0/)
{{< /alert >}}

#### Указание лицензии в проекте
* Каждый файл с кодом должен иметь указание лицензии в шапке

```
/*
 * Copyright 2020 LLC Leroy Merlin Vostok.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package ru.leroymerlin.delivery.tariff.convert;
```

* `README.md` должен упоминать лицензию

```
## License

This repository is released under version 2.0 of the 
[Apache License](https://www.apache.org/licenses/LICENSE-2.0).
```

* `LICENSE` файл в корне должен иметь [полный текст](https://www.apache.org/licenses/LICENSE-2.0.txt) лицензии.


### Шаг 3. Проверка совместимости сторонних зависимостей.
Сторонние компоненты и зависимости, а точнее их лицензии, могут требовать использование определённой лицензии в твоём проекте.
Обязательно процерить соовместимость лицензий между сторонними компонентами, а также между компонентами и лицензией проекта.

| Тип лицензии зависимости | Пример | Требуемые действия 
| --- | --- | --- 
| Разрешающие | `Apache` `BSD` `MIT` | None 
| Copyleft | `GPL` `LGPL` `AGPL` | <abbr data-toggle="tooltip" title="Убедиться, что лицензия разрешает распространение библиотеки под лицензией проекта либо совместно с другими библиотеками и их лицензиями">Проверить совместимость</abbr>
| Без лицензии | | Удалить или заменить компонент 
| Проприетарные | `Commercial` | Удалить или заменить компонент 
| Требующая принятие стороннего<br /> соглашения вместе с open source лицензией | `CLA` `CAA` | Принять соглашение <br />или удалить или заменить компонент 

## Все шаги пройдены
Поздравляю! Теперь можно выкладывать проект в open source. <i class="fa fa-glass-cheers"></i>

Для этого необходимо анонсировать желание в CI/CD канале в Слаке 
и они добавят ваш репозиторий в список исключения в специальном боте, который закрывает репозитории, открытые по ошибке.

После этого можно смело идти в настройки репозитория и выставить его видимость в `public`.